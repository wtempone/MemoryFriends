<ion-menu id="messages" side="right" [content]="game">
  <ion-header>
    <ion-toolbar>
      <ion-title>{{ 'MESSAGES' | translate }}</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item no-lines *ngFor="let msg of gameSession?.messages">
        <chat-bubble [message]="msg" [player]="gameSession?.players[msg.playerIndex]" [currentPlayerIndex]="currentPlayerIndex"></chat-bubble>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>

<ion-header>
  <ion-navbar>
    <ion-title>{{ 'APP_TITLE' | translate }}</ion-title>
    <ion-buttons end>
      <button ion-button icon-only (click)="gameMenu()">
        <ion-icon name="chatbubbles"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content #game>
  <ion-grid>
    <ion-row>
      <ion-col col-14>
        <player-card [player]="gameSession?.players[0]" [progress]="progress" [selected]="(gameSession?.playerTurn==0 && gameSession?.step == 2)"></player-card>
      </ion-col>
      <ion-col col-14>
        <ion-grid>
          <ion-row>
            <ion-col>
              <ion-title text-center>
                {{ 'SCORE' | translate }}
              </ion-title>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col col-14>
              <ion-title text-center>
                {{gameSession?.players[0].score}}
              </ion-title>
            </ion-col>
            <ion-col col-14>
              <ion-title text-center>
                x
              </ion-title>
            </ion-col>
            <ion-col col-14>
              <ion-title text-center>
                {{gameSession?.players[1].score}}
              </ion-title>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-col>
      <ion-col col-14>
        <player-card [player]="gameSession?.players[1]" [progress]="progress" [selected]="(gameSession?.playerTurn==1 && gameSession?.step == 2)"></player-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <select-num-cards *ngIf="gameSession?.step == 0" [ngClass]="{'bounceInLeft' : gameSession?.step == 0}" [gameSession]='gameSession'
    (selectNumCard)="setNumCard($event)">
  </select-num-cards>

  <select-cards *ngIf="gameSession?.step == 1" [gameSession]='gameSession' [gameSessionKey]='gameSessionKey' [currentPlayerIndex]='currentPlayerIndex'
    (done)="playerReady($event)">
  </select-cards>

  <game-play *ngIf="gameSession?.step == 2" [gameSession]='gameSession' [gameSessionKey]='gameSessionKey' [currentPlayerIndex]='currentPlayerIndex'
    (changeTurn)='changeTurn($event)'>
  </game-play>

  <end-game *ngIf="gameSession?.step == 3" [gameSession]='gameSession' [gameSessionKey]='gameSessionKey' [currentPlayerIndex]='currentPlayerIndex'
    (newGame)='newGame()' (exitGame)='exit()' (restartGame)='restartGame()'>
  </end-game>


</ion-content>
<ion-footer>
  <ion-toolbar>
    <ion-item>
      <ion-input #message placeholder="{{ 'SEND_A_MESSAGE' | translate }}"></ion-input>
      <ion-icon name="send" (click)="sendMessage(message.value);message.value='';" item-end></ion-icon>
    </ion-item>
  </ion-toolbar>
</ion-footer>